<!DOCTYPE html>
<html>
<head>
    <title>Font Upload Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-button { padding: 10px 20px; margin: 5px; }
        .form-button-secondary { background: #f0f0f0; border: 1px solid #ccc; }
        #font-preview { padding: 20px; border: 1px solid #ccc; background: #f9f9f9; }
    </style>
</head>
<body>
    <h1>Font Upload Test</h1>
    
    <div class="form-group">
        <label>Upload Font File</label>
        <div style="display: flex; align-items: center; gap: 10px;">
            <button class="form-button form-button-secondary" onclick="document.getElementById('font-upload-input').click();">选择字体文件</button>
            <span id="font-file-name">未选择文件</span>
        </div>
        <input type="file" id="font-upload-input" accept=".ttf,.otf,.woff,.woff2" style="display: none;">
    </div>

    <div class="form-group">
        <label>Preview</label>
        <div id="font-preview">
            <p style="font-size: 20px; margin: 0 0 10px 0;">你好世界 Hello World</p>
            <p style="margin: 0;">这是字体预览效果，12345。</p>
        </div>
    </div>

    <script>
        function handleFontUpload(file) {
            if (!file) return;
            
            try {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const fontDataUrl = e.target.result;
                    
                    // Create font face
                    const fontName = 'test-font';
                    const style = document.createElement('style');
                    style.innerHTML = `
                        @font-face {
                            font-family: '${fontName}';
                            src: url('${fontDataUrl}');
                            font-display: swap;
                        }
                    `;
                    document.head.appendChild(style);
                    
                    // Apply to preview
                    document.getElementById('font-preview').style.fontFamily = `'${fontName}', Arial, sans-serif`;
                };
                reader.readAsDataURL(file);
                
                document.getElementById('font-file-name').textContent = file.name;
                
            } catch (error) {
                console.error('Font upload error:', error);
                alert('字体文件上传失败，请重试。');
            }
        }

        document.getElementById('font-upload-input').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleFontUpload(file);
            }
        });
    </script>
</body>
</html>